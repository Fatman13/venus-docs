(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{377:function(e,t,a){"use strict";a.r(t);var s=a(25),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"storing-on-filecoin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#storing-on-filecoin"}},[e._v("#")]),e._v(" Storing on Filecoin")]),e._v(" "),a("p",[e._v("This section provides instructions for making storage deals with miners and retrieving the files afterwards.")]),e._v(" "),a("h2",{attrs:{id:"table-of-contents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table-of-contents"}},[e._v("#")]),e._v(" Table of contents")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#how-to-store-on-filecoin"}},[e._v("How to store on Filecoin")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#test-filecoin-with-sample-data"}},[e._v("Test Filecoin with sample data")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#import-data"}},[e._v("Import data")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#propose-a-storage-deal"}},[e._v("Propose a storage deal")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#send-data-and-pay-miner"}},[e._v("Send data and pay miner")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#retrieving-data"}},[e._v("Retrieving data")])])]),e._v(" "),a("h2",{attrs:{id:"how-to-store-on-filecoin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-store-on-filecoin"}},[e._v("#")]),e._v(" How to store on Filecoin")]),e._v(" "),a("p",[e._v("Because Filecoin is a decentralized storage marketplace, storage clients (our term for anyone who wants to store data on the Filecoin network) propose storage deals with storage miners that they feel can meet their storage needs. Once a storage client has proposed a deal, the miner can choose to accept or reject that deal. The client then sends over the data, and the storage deal officially begins.")]),e._v(" "),a("p",[e._v("In order to run the remainder of these commands, ensure a Filecoin node is installed and currently running. See the "),a("a",{attrs:{href:"Getting-Started"}},[e._v("getting started")]),e._v(" section of this documentation for more information.")]),e._v(" "),a("h2",{attrs:{id:"test-filecoin-with-sample-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-filecoin-with-sample-data"}},[e._v("#")]),e._v(" Test Filecoin with sample data")]),e._v(" "),a("p",[e._v("It is recommended to use small test files while initially getting used to the different commands. If preferred, there is a folder of "),a("a",{attrs:{href:"https://github.com/filecoin-project/sample-data",target:"_blank",rel:"noopener noreferrer"}},[e._v("sample data"),a("OutboundLink")],1),e._v(" (images, GIFs, and text files) that can be used to get started. Download this data, unzip it, and save it anywhere. In the examples below, it is assumed that the repository is saved to the Desktop ("),a("code",[e._v("~/Desktop")]),e._v(").")]),e._v(" "),a("h2",{attrs:{id:"import-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#import-data"}},[e._v("#")]),e._v(" Import data")]),e._v(" "),a("p",[e._v("Before storing data on the Filecoin network, import the data into the local Filecoin node:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Start by creating a simple .txt file")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Hi my name is '),a("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$USER")]),e._v('"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" hello.txt\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Import the created file into go-filecoin.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# RETURN VAL: Content ID (CID) of this file.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# You'll need this CID for future commands to")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# view, store, or retrieve this data.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("CID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),e._v("go-filecoin client "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("import")]),e._v(" ./hello.txt"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# View the imported file")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# RETURN VAL: "Hi my name is user1"')]),e._v("\ngo-filecoin client "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$CID")]),e._v("\n")])])]),a("p",[e._v("To import files from the local machine:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Import an image from the sample data. Returns")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# its CID which you'll need for the next step.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("CID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),e._v("go-filecoin client "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("import")]),e._v(" ~/Desktop/sample-data-master/camel.jpg"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# View imported image")]),e._v("\ngo-filecoin client "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$CID")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" image.jpg "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("open")]),e._v(" image.jpg\n")])])]),a("h2",{attrs:{id:"propose-a-storage-deal"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#propose-a-storage-deal"}},[e._v("#")]),e._v(" Propose a storage deal")]),e._v(" "),a("p",[e._v("Once the data is imported, it is possible to look through available "),a("em",[e._v("ask orders")]),e._v(" from miners. Manually choose one of them and propose a storage deal.")]),e._v(" "),a("p",[e._v("To see all available asks, run this command:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("go-filecoin client list-asks --enc"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("json "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" jq\n")])])]),a("p",[e._v("A list of asks will be generated in "),a("code",[e._v("json")]),e._v(" format:")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Miner"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"fcqxvnl37zdv8clc26j6r43zn8md7tc2mrfx77vru"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2.5"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Expiry"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("588")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"ID"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Error"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token null keyword"}},[e._v("null")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("The price is in FIL per byte per blocktime (~30s), and the expiry is the blockchain height at which the ask expires. Choose an ask from that list. For now, the biggest difference between miners will be price. In the future, miners may have other characteristics.")]),e._v(" "),a("p",[e._v("Proposing a storage deal requires four parameters:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("<miner>")]),e._v(" address of the miner from "),a("code",[e._v("list-asks")])]),e._v(" "),a("li",[a("code",[e._v("<data>")]),e._v(" CID of the imported data to be stored")]),e._v(" "),a("li",[a("code",[e._v("<ask>")]),e._v(" ID of the ask, also from "),a("code",[e._v("list-asks")]),e._v(" (usually 0)")]),e._v(" "),a("li",[a("code",[e._v("<duration>")]),e._v(" how long to store (in # of ~30sec blocktimes). For example, storing for 1 day (2 blocks/min * 60 min/hr * 24 hr/day) = 2880 blocks.")])]),e._v(" "),a("p",[e._v("Supplied in the following command:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("go-filecoin client propose-storage-deal "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("miner"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("ask"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("duration"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("p",[e._v("If the deal is proposed correctly, it will automatically be accepted and return "),a("code",[e._v("Status: accepted")]),e._v(". Currently, a deal will fail if the required capacity exceeds what that miner has available. A deal will also fail if the client account's wallet FIL balance is insufficient to cover the asking cost over the proposed data size and duration.")]),e._v(" "),a("h2",{attrs:{id:"send-data-and-pay-miner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#send-data-and-pay-miner"}},[e._v("#")]),e._v(" Send data and pay miner")]),e._v(" "),a("p",[e._v("As part of negotiating the deal, the "),a("code",[e._v("propose-storage-deal")]),e._v(" command will automatically move the funds required for covering the deal's total into a payment channel with the storage miner.  This payment channel will periodically release payments to the storage miner across the lifetime of the deal.")]),e._v(" "),a("p",[e._v("Data is automatically transferred to a staging area via the underlying "),a("a",{attrs:{href:"https://github.com/ipfs/specs/tree/master/bitswap",target:"_blank",rel:"noopener noreferrer"}},[e._v("bitswap"),a("OutboundLink")],1),e._v(' mechanism (implementation from IPFS) of Filecoin. Miners will now be required to store files on their machines and begin the sealing/proving process. Under the hood, filecoin miners automatically fire off a sealing process at a configured interval (defaulted to 120 seconds) to take all data in the miner\'s staging area and seal it into the miner\'s pledged storage sectors.  The deal status will move to "staged" at this point.  After sealing is complete and the miner posts its commitment to the chain, the deal status will move to "posted".')]),e._v(" "),a("p",[e._v("Check the deal state:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("go-filecoin client query-storage-deal "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("dealID"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("p",[e._v('Once it reads "posted, you will have successfully stored your data!", the data is now available for retrieval.')]),e._v(" "),a("h2",{attrs:{id:"retrieving-data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#retrieving-data"}},[e._v("#")]),e._v(" Retrieving data")]),e._v(" "),a("p",[e._v("Before data can be retrieved from a sealed sector, the sector must be unsealed. Sealing and unsealing times vary depending on the size of the sector, and may range from a few minutes to a few hours.")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Retrieve your data, using the address of the")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# miner you made a deal with and the <CID> of the data.")]),e._v("\ngo-filecoin retrieval-client retrieve-piece "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("minerAddress"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("CID"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# can take a minute")]),e._v("\n")])])]),a("p",[e._v("Congratulations! You have now walked through several of the client commands available on Filecoin. Let us know if you have any questions by dropping a message on Slack/Matrix (#fil-help) or the "),a("a",{attrs:{href:"https://discuss.filecoin.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("community forum"),a("OutboundLink")],1),e._v(", and take a look at the "),a("a",{attrs:{href:"Troubleshooting-&-FAQ"}},[e._v("Troubleshooting & FAQs page")]),e._v(".")])])}),[],!1,null,null,null);t.default=r.exports}}]);