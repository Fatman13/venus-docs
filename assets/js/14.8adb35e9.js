(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{376:function(e,t,a){"use strict";a.r(t);var s=a(25),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"running-a-local-network"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#running-a-local-network"}},[e._v("#")]),e._v(" Running a local network")]),e._v(" "),a("p",[e._v("This section includes instructions for deploying a local network either manually with "),a("code",[e._v("gengen")]),e._v(" or automatically with "),a("code",[e._v("localnet")]),e._v(" for development or testing purposes.")]),e._v(" "),a("h2",{attrs:{id:"table-of-contents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table-of-contents"}},[e._v("#")]),e._v(" Table of contents")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#manual-network-setup-with-gengen-tool"}},[e._v("Manual network setup with gengen tool")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#configuration"}},[e._v("Configuration")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#generated-output"}},[e._v("Generated output")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#using-the-output"}},[e._v("Using the output")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#automatic-network-setup-with-localnet-tool"}},[e._v("Automatic network setup with localnet tool")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#basic-usage"}},[e._v("Basic usage")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#regular-sectors"}},[e._v("Regular sectors")])])])])]),e._v(" "),a("h2",{attrs:{id:"manual-network-setup-with-gengen-tool"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#manual-network-setup-with-gengen-tool"}},[e._v("#")]),e._v(" Manual network setup with gengen tool")]),e._v(" "),a("p",[e._v("The "),a("a",{attrs:{href:"https://github.com/filecoin-project/go-filecoin/blob/master/tools/gengen/README.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("gengen tool"),a("OutboundLink")],1),e._v(" is a command line utility used to generate the assets required to bootstrap a network, including a "),a("code",[e._v("genesis.car")]),e._v(" file.")]),e._v(" "),a("h3",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),a("p",[a("code",[e._v("gengen")]),e._v(" uses a configuration file to describe the assets it will produce. The file describes the number of wallets (account actors) that will be generated, the balance of each wallet, and if the wallet has a miner associated with it.")]),e._v(" "),a("h4",{attrs:{id:"config-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#config-json"}},[e._v("#")]),e._v(" config.json")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"keys"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"preAlloc"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"3000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"4000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"5000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"miners"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"owner"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"power"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("blockquote",[a("p",[a("strong",[e._v("NOTICE:")]),e._v(" A default configuration is provided in the "),a("a",{attrs:{href:"https://github.com/filecoin-project/go-filecoin/blob/master/fixtures/setup.json",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("go-filecoin/fixtures/")]),a("OutboundLink")],1),e._v(" directory.")])]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("keys")]),e._v(" property defines the number of wallets to create. This will produce a set of files "),a("code",[e._v("0.key...n.key")]),e._v(", where "),a("code",[e._v("n")]),e._v(" is the value of "),a("code",[e._v("keys - 1")]),e._v(". The files will be produced in the working directory, though the output can be changed by providing the "),a("code",[e._v("-keypath")]),e._v(" when running the "),a("code",[e._v("gengen")]),e._v(" command.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("preAlloc")]),e._v(" property defines the preallocated funds for the wallet. The numerical value (represented as a string to support large values) is associated with a key by the position it has in the array. This means that the wallet, with key "),a("code",[e._v("0.key")]),e._v(", will have "),a("code",[e._v("1000")]),e._v(" FIL, while "),a("code",[e._v("4.key")]),e._v(" will have "),a("code",[e._v("5000")]),e._v(".")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("miners")]),e._v(" property defines a miner and the amount of power it will have on the network. Power is a measurement of sealed sectors. Currently this power is fake; but for the most part, it fully simulates a production experience. Gengen "),a("a",{attrs:{href:"https://github.com/filecoin-project/go-filecoin/issues/2270",target:"_blank",rel:"noopener noreferrer"}},[e._v("soon may create real sealed sectors"),a("OutboundLink")],1),e._v(". It is best to keep this power value low. The "),a("code",[e._v("owner")]),e._v(" is the key index, so key "),a("code",[e._v("0.key")]),e._v(" would be owner "),a("code",[e._v("0")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"generated-output"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generated-output"}},[e._v("#")]),e._v(" Generated output")]),e._v(" "),a("p",[e._v("There are two main outputs from "),a("code",[e._v("gengen")]),e._v(", with the additional of the "),a("code",[e._v("n.key")]),e._v(" files for easy importing.")]),e._v(" "),a("p",[a("strong",[e._v("-out-car")]),e._v("\nThis options defines the location and name of the "),a("code",[e._v("car")]),e._v(" file. Generally, this file is named "),a("code",[e._v("genesis.car")]),e._v(". This file is used to load the genesis block into nodes by providing the "),a("code",[e._v("--genesisfile")]),e._v(" option during "),a("code",[e._v("go-filecoin init")]),e._v(".")]),e._v(" "),a("p",[a("strong",[e._v("-out-json")]),e._v("\nThis options defines the location and name of the address information. This file contains the wallet private keys, as well as the miner addresses. The private keys in this file are the same as the key files "),a("code",[e._v("0.key...n.key")]),e._v(". The key files\nare provided as an easier way to import the individual keys.")]),e._v(" "),a("h3",{attrs:{id:"using-the-output"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-the-output"}},[e._v("#")]),e._v(" Using the output")]),e._v(" "),a("p",[e._v("The following file describes the how to use the files inside of "),a("code",[e._v("fixtures")]),e._v(" to configure a node to use the information inside of the genesis file.")]),e._v(" "),a("p",[e._v("The genesis file contains the seed of the chain. The block contains messages that gives power to one miner and tokens to certain other address (account actors / wallets). To use the miner in the genesis, the miner owner (account actor / wallet) must be imported, followed by configuration changes and updating the "),a("code",[e._v("peerid")]),e._v(" associated with the miner.")]),e._v(" "),a("blockquote",[a("p",[a("strong",[e._v("NOTICE:")]),e._v(" The following commands assume you are running inside of the "),a("code",[e._v("go-filecoin")]),e._v(" source directory. Each block below is expected to be run in a different terminal window.")])]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Initialise the genesis file and start the daemon:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("./go-filecoin init --genesisfile"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("./fixtures/test/genesis.car\n./go-filecoin daemon\n")])])])]),e._v(" "),a("li",[a("p",[e._v("In another terminal, enter the following:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("mineraddr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.Miners[0].Address'")]),e._v(" ./fixtures/test/gen.json"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("peerid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("./go-filecoin --enc"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("json "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("id")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.ID'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n./go-filecoin config mining.minerAddress "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$mineraddr")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("walletaddr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("./go-filecoin --enc"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("json wallet "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("import")]),e._v(" ./fixtures/test/0.key "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.Addresses[0]'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n./go-filecoin config wallet.defaultAddress "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$walletaddr")]),e._v("\n./go-filecoin miner update-peerid --from "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$walletaddr")]),e._v(" --gas-price "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0.001")]),e._v(" --gas-limit"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("300")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$mineraddr")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$peerid")]),e._v("\n./go-filecoin mining start\n./go-filecoin wallet balance "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$walletaddr")]),e._v("\n")])])])])]),e._v(" "),a("p",[e._v("This will generate a non-zero balance. Setting up additional miners can be achieved by following the standard method, and using this genesis node as a way to receive funds.")]),e._v(" "),a("h2",{attrs:{id:"automatic-network-setup-with-localnet-tool"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#automatic-network-setup-with-localnet-tool"}},[e._v("#")]),e._v(" Automatic network setup with localnet tool")]),e._v(" "),a("p",[e._v("The "),a("a",{attrs:{href:"https://github.com/filecoin-project/go-filecoin/tree/master/tools/fast/bin/localnet",target:"_blank",rel:"noopener noreferrer"}},[e._v("localnet tool"),a("OutboundLink")],1),e._v(" is built using our "),a("a",{attrs:{href:"https://github.com/filecoin-project/go-filecoin/tree/master/tools/fast",target:"_blank",rel:"noopener noreferrer"}},[e._v("FAST library"),a("OutboundLink")],1),e._v(". It provides an automated way to setup a localnet, removing the extra steps involved with using "),a("code",[e._v("gengen")]),e._v(" and juggling the execution of commands against different filecoin repositories.")]),e._v(" "),a("p",[a("code",[e._v("localnet")]),e._v(" goes a bit further and handles the construction of miner nodes, which you will have to do manually if using "),a("code",[e._v("gengen")]),e._v(". All configuration for "),a("code",[e._v("localnet")]),e._v(" can be found in the README linked above.")]),e._v(" "),a("p",[a("code",[e._v("localnet")]),e._v(" must be built, and is only compatible with "),a("code",[e._v("go-filecoin")]),e._v(" binaries built from the same commit.")]),e._v(" "),a("p",[e._v("To build "),a("code",[e._v("localnet")]),e._v(", issue the following commands:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" tools/fast/bin/localnet\ngo build -o localnet main.go\n")])])]),a("h3",{attrs:{id:"basic-usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-usage"}},[e._v("#")]),e._v(" Basic usage")]),e._v(" "),a("p",[e._v("When using all the default flags, "),a("code",[e._v("localnet")]),e._v(" will use the "),a("code",[e._v("go-filecoin")]),e._v(" binary located in the project directory under "),a("code",[e._v("filecoin-project/go-filecoin")]),e._v(". It will default to our small sectors, creating five miners. The "),a("code",[e._v("-shell")]),e._v(" flag tells "),a("code",[e._v("localnet")]),e._v(" to create an additional node and launches your shell with "),a("code",[e._v("go-filecoin")]),e._v(" setup correctly in your path, ready to use. The node will already be connect to all the miners and have 100,000 FIL in its default wallet.")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("localnet $ ./localnet -shell\n")])])]),a("h3",{attrs:{id:"regular-sectors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#regular-sectors"}},[e._v("#")]),e._v(" Regular sectors")]),e._v(" "),a("p",[e._v("Using regular sized sectors with "),a("code",[e._v("localnet")]),e._v(" can be incredibly taxing on a system and should be avoided\non laptops due to the number of miners running. The overall miner count can be reduced from the default "),a("code",[e._v("5")]),e._v(" by passing the "),a("code",[e._v("-miner-count")]),e._v(" flag:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("localnet $ ./localnet -small-sectors"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("false -miner-count"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" -shell\n")])])]),a("p",[e._v("See "),a("code",[e._v("./localnet -help")]),e._v(" for additional configuration options, or refer to the localnet README linked above.")])])}),[],!1,null,null,null);t.default=n.exports}}]);